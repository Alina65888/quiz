<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>SIBUR QUIZ BATTLE ¬∑ v0.4 UI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    :root {
      --sibur-teal: #009CA6;
      --sibur-teal-dark: #006D73;
      --bg-light: #F5F7F8;
      --text-main: #001F23;
      --gray-soft: #E6E6E6;
      --danger: #D94747;
      --success: #36A766;
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #E2F5F6 0, #F7FAFB 55%, #EDF3F4 100%);
      color: var(--text-main);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      position: relative;
      overflow: hidden;
      isolation: isolate;
    }

    body::before,
    body::after {
      content: "";
      position: absolute;
      width: 520px;
      height: 520px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(0, 156, 166, 0.28), transparent 70%);
      filter: blur(6px);
      z-index: -2;
      animation: float-cloud 14s ease-in-out infinite;
    }

    body::before { top: -220px; right: -120px; animation-delay: -2s; }
    body::after { bottom: -240px; left: -120px; animation-delay: -6s; }

    @keyframes float-cloud {
      0%, 100% { transform: translateY(-10px) scale(1); }
      50% { transform: translateY(16px) scale(1.05); }
    }

    .app {
      width: 100%;
      max-width: 480px;
      min-height: 100vh;
      background: linear-gradient(160deg, rgba(255, 255, 255, 0.92) 0%, rgba(243, 251, 252, 0.94) 45%, rgba(231, 245, 246, 0.9) 100%);
      box-shadow: 0 18px 40px rgba(0, 50, 60, 0.18);
      border-radius: 32px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      border: 1px solid rgba(0, 156, 166, 0.15);
      position: relative;
      backdrop-filter: blur(8px);
    }

    .app::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% -10%, rgba(0, 156, 166, 0.18), transparent 45%),
                  radial-gradient(circle at 90% 0%, rgba(0, 156, 166, 0.12), transparent 30%);
      opacity: 0.5;
      pointer-events: none;
    }

    header.app-header {
      padding: 18px 24px 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(135deg, var(--sibur-teal-dark), var(--sibur-teal));
      color: white;
      box-shadow: inset 0 -1px 0 rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }

    header.app-header::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.22), transparent 55%);
      mix-blend-mode: screen;
    }

    .header-logo {
      font-weight: 800;
      letter-spacing: 0.08em;
      font-size: 16px;
    }

    .header-badge {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      text-transform: uppercase;
      opacity: 0.9;
    }

    main {
      flex: 1;
      padding: 20px 22px 26px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      position: relative;
    }

    main::before {
      content: "";
      position: absolute;
      inset: 12px;
      border-radius: 26px;
      border: 1px dashed rgba(0, 156, 166, 0.15);
      opacity: 0.5;
      pointer-events: none;
    }

    .screen {
      display: none;
      flex-direction: column;
      gap: 16px;
      height: 100%;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.28s ease, transform 0.28s ease;
    }

    .screen.active {
      display: flex;
      opacity: 1;
      transform: translateY(0);
    }

    .card {
      background: rgba(255, 255, 255, 0.94);
      border-radius: calc(var(--radius-lg) + 2px);
      padding: 16px 18px;
      box-shadow: 0 12px 30px rgba(0, 40, 50, 0.08);
      animation: card-pop 0.3s ease;
      border: 1px solid rgba(0, 156, 166, 0.08);
      position: relative;
      overflow: hidden;
    }

    .card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.45), transparent 65%);
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .card:hover::after { opacity: 1; }

    .card-hero {
      background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.98), rgba(212, 244, 246, 0.95));
      padding: 22px 22px 24px;
      border: 1px solid rgba(0, 156, 166, 0.12);
    }

    .card-hero::before {
      content: "";
      position: absolute;
      top: -60px;
      right: -80px;
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.55), transparent 70%);
      filter: blur(2px);
    }

    @keyframes card-pop {
      from { opacity: 0; transform: translateY(8px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .card-title {
      font-weight: 700;
      font-size: 19px;
      letter-spacing: -0.01em;
    }

    .card-subtitle {
      font-size: 13px;
      opacity: 0.8;
      margin-top: 4px;
      line-height: 1.4;
    }

    .pill {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--gray-soft);
      background: rgba(255, 255, 255, 0.9);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 12px 14px;
      border-radius: 999px;
      border: none;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease, filter 0.08s ease, background 0.1s ease;
      position: relative;
      overflow: hidden;
      letter-spacing: 0.02em;
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.15);
    }

    .btn::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at center, rgba(255,255,255,0.4), transparent 55%);
      opacity: 0;
      transition: opacity 0.15s ease;
    }

    .btn:active::after { opacity: 1; }

    .btn::before {
      content: "";
      position: absolute;
      top: -50%;
      width: 60%;
      height: 200%;
      background: linear-gradient(120deg, rgba(255,255,255,0), rgba(255,255,255,0.45), rgba(255,255,255,0));
      transform: translateX(-120%) rotate(8deg);
      transition: transform 0.4s ease;
    }

    .btn:hover::before { transform: translateX(160%) rotate(8deg); }

    .btn-primary {
      background: linear-gradient(135deg, var(--sibur-teal), var(--sibur-teal-dark));
      color: white;
      box-shadow: 0 10px 22px rgba(0, 80, 90, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.92);
      border: 1px solid rgba(0, 156, 166, 0.25);
      color: var(--sibur-teal-dark);
      box-shadow: 0 10px 20px rgba(0, 30, 40, 0.08);
    }

    .btn-ghost {
      background: rgba(255, 255, 255, 0.5);
      border: 1px dashed rgba(0, 156, 166, 0.4);
      color: var(--sibur-teal-dark);
    }

    .btn:active {
      transform: scale(0.97) translateY(1px);
      box-shadow: 0 6px 16px rgba(0, 60, 70, 0.2);
      filter: brightness(0.98);
    }

    .btn-row { display: flex; gap: 10px; }
    .btn-small { padding-block: 8px; font-size: 13px; }

    .profile-row { display: flex; gap: 12px; align-items: center; }

    .avatar {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      background: linear-gradient(145deg, #ffffff, #DEF3F5 65%, rgba(0, 156, 166, 0.14));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 18px;
      color: var(--sibur-teal-dark);
      border: 2px solid rgba(0, 156, 166, 0.25);
      box-shadow: 0 6px 14px rgba(0, 80, 90, 0.2);
      position: relative;
    }

    .avatar::after {
      content: "";
      position: absolute;
      inset: 4px;
      border-radius: inherit;
      border: 1px solid rgba(255, 255, 255, 0.7);
      opacity: 0.7;
    }

    .profile-meta { font-size: 12px; opacity: 0.7; }

    .stats-row {
      display: flex;
      gap: 10px;
      margin-top: 8px;
      font-size: 12px;
      flex-wrap: wrap;
    }

    .chip {
      border-radius: 999px;
      padding: 4px 10px;
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(0, 156, 166, 0.15);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip span.icon { font-size: 14px; }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .menu-item {
      border-radius: var(--radius-lg);
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.96), rgba(226, 246, 247, 0.7));
      padding: 12px 13px;
      border: 1px solid rgba(0, 156, 166, 0.1);
      box-shadow: 0 6px 14px rgba(0, 40, 50, 0.06);
      cursor: pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.1s ease;
      position: relative;
      overflow: hidden;
    }

    .menu-item::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(255, 255, 255, 0.7), transparent 60%);
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .menu-item:hover {
      transform: translateY(-2px) scale(1.01);
      box-shadow: 0 12px 20px rgba(0, 40, 50, 0.12);
    }

    .menu-item:hover::after { opacity: 1; }

    .menu-item-title { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
    .menu-item-subtitle { font-size: 11px; opacity: 0.7; line-height: 1.4; }

    .menu-pill {
      font-size: 10px;
      margin-top: 6px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(0, 156, 166, 0.08);
      color: var(--sibur-teal-dark);
      display: inline-block;
    }

    .footer-info {
      text-align: center;
      font-size: 11px;
      opacity: 0.7;
      line-height: 1.4;
    }

    .duel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      margin-bottom: 8px;
    }

    .versus-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .vs-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      opacity: 0.7;
    }

    .score-chip {
      font-size: 13px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.04);
    }

    .timer-bar {
      position: relative;
      width: 100%;
      height: 7px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.05);
      overflow: hidden;
      margin-bottom: 10px;
    }

    .timer-fill {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--sibur-teal), #F7C948);
      transform-origin: left;
      transform: scaleX(1);
      transition: transform 0.1s linear;
      box-shadow: 0 0 12px rgba(0, 156, 166, 0.35);
    }

    .question-text {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .question-meta {
      font-size: 12px;
      opacity: 0.7;
      margin-bottom: 10px;
    }

    .answers { display: flex; flex-direction: column; gap: 10px; }

    .answer-btn {
      width: 100%;
      border-radius: 16px;
      padding: 11px 14px;
      border: 1px solid rgba(0, 156, 166, 0.15);
      background: rgba(255, 255, 255, 0.96);
      text-align: left;
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      transition: background 0.1s ease, border-color 0.1s ease, transform 0.12s ease, box-shadow 0.12s ease;
      box-shadow: 0 4px 12px rgba(0, 40, 50, 0.08);
    }

    .answer-btn span.index {
      font-weight: 600;
      font-size: 11px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(0, 156, 166, 0.15);
      color: var(--sibur-teal-dark);
      min-width: 22px;
      text-align: center;
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.5);
    }

    .answer-btn span.text { flex: 1; }

    .answer-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0, 40, 50, 0.12);
    }

    .answer-btn.correct {
      background: rgba(54, 167, 102, 0.14);
      border-color: rgba(54, 167, 102, 0.7);
      animation: answer-pop 0.25s ease;
      box-shadow: 0 6px 18px rgba(54, 167, 102, 0.25);
    }

    .answer-btn.wrong {
      background: rgba(217, 71, 71, 0.12);
      border-color: rgba(217, 71, 71, 0.7);
      animation: answer-shake 0.25s ease;
      box-shadow: 0 6px 16px rgba(217, 71, 71, 0.25);
    }

    .answer-btn.disabled { opacity: 0.75; cursor: default; }

    @keyframes answer-pop {
      0% { transform: scale(0.98); }
      60% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }

    @keyframes answer-shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      50% { transform: translateX(3px); }
      75% { transform: translateX(-2px); }
      100% { transform: translateX(0); }
    }

    .small-label { font-size: 11px; opacity: 0.7; }

    .result-main-score {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 6px;
    }

    .result-status {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .result-delta { font-size: 12px; opacity: 0.8; }

    .list { display: flex; flex-direction: column; gap: 8px; font-size: 13px; }
    .list-item { display: flex; justify-content: space-between; align-items: center; }

    .badge-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .badge-card {
      border-radius: var(--radius-lg);
      padding: 11px 12px;
      background: rgba(255, 255, 255, 0.94);
      border: 1px solid rgba(0, 156, 166, 0.1);
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
      box-shadow: 0 6px 14px rgba(0, 40, 50, 0.06);
    }

    .badge-pill {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(0, 156, 166, 0.09);
      align-self: flex-start;
    }

    .badge-card.locked { opacity: 0.55; }

    .pill-inline {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.04);
      font-size: 11px;
    }

    .leader-header-row {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      opacity: 0.7;
      margin-bottom: 6px;
    }

    .leader-list { display: flex; flex-direction: column; gap: 6px; font-size: 13px; }

    .leader-row {
      display: grid;
      grid-template-columns: 24px 1fr auto;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(0, 156, 166, 0.04);
      box-shadow: inset 0 0 0 1px rgba(0, 156, 166, 0.08);
    }

    .leader-row.me { background: rgba(0, 156, 166, 0.08); font-weight: 600; }
    .leader-pos { text-align: center; font-size: 12px; opacity: 0.7; }

    .leader-name { display: flex; flex-direction: column; }
    .leader-name-main { font-size: 13px; }
    .leader-name-sub { font-size: 11px; opacity: 0.7; }

    .leader-score { font-size: 12px; text-align: right; }

    @media (max-width: 520px) {
      .app { border-radius: 18px; max-width: none; min-height: 100vh; }
      header.app-header { border-radius: 18px 18px 0 0; }
      main::before { display: none; }
    }
  </style>
</head>
<body>
<div class="app">
  <header class="app-header">
    <div class="header-logo">SIBUR QUIZ</div>
    <div class="header-badge">–ú–µ—Ä—á-–±–∞—Ç–ª</div>
  </header>

  <main>
    <!-- Splash / Login -->
    <section class="screen active" id="screen-splash">
      <div class="card card-hero">
        <div class="card-header">
          <div>
            <div class="card-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</div>
            <div class="card-subtitle">
              –ö–≤–∏–∑-–¥—É—ç–ª–∏ –ø–æ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º –°–ò–ë–£–†–∞.
              –ò–≥—Ä–∞–µ—à—å ‚Äî –ø–æ–¥–Ω–∏–º–∞–µ—à—å —Ä–µ–π—Ç–∏–Ω–≥ –∏ —Å–æ—Ä–µ–≤–Ω—É–µ—à—å—Å—è —Å –∫–æ–ª–ª–µ–≥–∞–º–∏.
            </div>
          </div>
        </div>
        <div style="margin-top: 12px; font-size: 12px; display: flex; flex-direction: column; gap: 4px;">
          <span>‚ö° –î—É—ç–ª—å ‚Äî –æ–∫–æ–ª–æ 40‚Äì60 —Å–µ–∫—É–Ω–¥ (–±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ—Ç–≤–µ—Ç)</span>
          <span>üèÖ –†–µ–π—Ç–∏–Ω–≥ –∑–∞ –∫–∞–∂–¥—É—é —Å—ã–≥—Ä–∞–Ω–Ω—É—é –¥—É—ç–ª—å</span>
          <span>üß† –£–∑–Ω–∞—ë—à—å –±–æ–ª—å—à–µ –æ –∫–æ–º–ø–∞–Ω–∏–∏ –±–µ–∑ ‚Äú—É—á–µ–±–Ω–∏–∫–∞‚Äù</span>
        </div>
      </div>

      <div class="card">
        <div class="section-title">–í—Ö–æ–¥</div>
        <p style="font-size: 13px; opacity: 0.8; margin-bottom: 10px;">
          –í–≤–µ–¥–∏—Ç–µ –∏–º—è ‚Äî –∏ —Å—Ä–∞–∑—É –≤ –±–æ–π. –í –ø—Ä–æ–¥-–≤–µ—Ä—Å–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è SSO.
        </p>
        <div style="display:flex;flex-direction:column;gap:8px;">
          <input id="input-name" type="text" placeholder="–í–∞—à–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è"
                 style="padding:9px 10px;border-radius:999px;border:1px solid var(--gray-soft);font-size:14px;width:100%;outline:none;">
          <button class="btn btn-primary" id="btn-enter">–í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</button>
          <button class="btn btn-ghost btn-small" id="btn-demo-name">–ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–µ–º–æ-–∏–º–µ–Ω–µ–º</button>
        </div>
      </div>

      <div class="footer-info">
        –ü—Ä–æ—Ç–æ—Ç–∏–ø 0.4 ¬∑ –ë–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö ¬∑ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä—è–º–æ –∏–∑ —Ñ–∞–π–ª–∞ .html
      </div>
    </section>

    <!-- Main menu -->
    <section class="screen" id="screen-main">
      <div class="card card-hero">
        <div class="profile-row">
          <div class="avatar" id="player-avatar">S</div>
          <div>
            <div id="player-name" style="font-weight: 700;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –°–ò–ë–£–†</div>
            <div class="profile-meta" id="player-meta">–†–µ–π—Ç–∏–Ω–≥: 100 ¬∑ –î—É—ç–ª–µ–π: 0</div>
            <div class="stats-row">
              <div class="chip">
                <span class="icon">üèÖ</span><span id="player-rating-label">–ù–æ–≤–∏—á–æ–∫</span>
              </div>
              <div class="chip">
                <span class="icon">üéØ</span><span id="player-battles-label">0 –¥—É—ç–ª–µ–π</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="section-title">–ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å</div>
        <p class="card-subtitle">
          5 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º –°–ò–ë–£–†–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º –∏ —ç–∫–æ–ª–æ–≥–∏–∏.
          –ü–æ–±–µ–∂–¥–∞–µ—Ç —Ç–æ—Ç, –∫—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –∏ —Ç–æ—á–Ω–µ–µ.
        </p>
        <div style="margin-top: 10px; display:flex; flex-direction:column; gap:8px;">
          <button class="btn btn-primary" id="btn-play-quick">–ò–≥—Ä–∞—Ç—å –¥—É—ç–ª—å</button>
          <button class="btn btn-secondary btn-small" id="btn-play-bot">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å –ò–ò-—Å–æ–ø–µ—Ä–Ω–∏–∫–æ–º</button>
        </div>
      </div>

      <div class="card">
        <div class="section-title">–í–∞—à–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
        <div class="menu-grid">
          <div class="menu-item" id="menu-leaderboard">
            <div class="menu-item-title">–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
            <div class="menu-item-subtitle">–°—Ä–∞–≤–Ω–∏—Ç–µ —Å–≤–æ–π —Ä–µ–π—Ç–∏–Ω–≥ —Å –∫–æ–ª–ª–µ–≥–∞–º–∏ –≤ –¥–µ–º–æ-–ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ.</div>
            <div class="menu-pill">üèÜ –õ–∏–¥–µ—Ä–±–æ—Ä–¥</div>
          </div>
          <div class="menu-item" id="menu-badges">
            <div class="menu-item-title">–ë–µ–π–¥–∂–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π</div>
            <div class="menu-item-subtitle">‚Äú–ó–Ω–∞—Ç–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏‚Äù, ‚Äú–ò–Ω–Ω–æ–≤–∞—Ç–æ—Ä‚Äù –∏ –¥—Ä—É–≥–∏–µ –∑–≤–∞–Ω–∏—è.</div>
            <div class="menu-pill">‚≠ê –ö–æ–ª–ª–µ–∫—Ü–∏—è</div>
          </div>
          <div class="menu-item" id="menu-stats">
            <div class="menu-item-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            <div class="menu-item-subtitle">–ü–æ–±–µ–¥—ã, –ø–æ—Ä–∞–∂–µ–Ω–∏—è –∏ —Å–∏–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤.</div>
            <div class="menu-pill">üìä –í –ø—Ä–æ—Ç–æ—Ç–∏–ø–µ –∑–∞–≥–ª—É—à–∫–∞</div>
          </div>
          <div class="menu-item" id="menu-settings">
            <div class="menu-item-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="menu-item-subtitle">–ê–≤–∞—Ç–∞—Ä, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.</div>
            <div class="menu-pill">‚öôÔ∏è –í –ø—Ä–æ—Ç–æ—Ç–∏–ø–µ –∑–∞–≥–ª—É—à–∫–∞</div>
          </div>
        </div>
      </div>

      <div class="footer-info">
        –°–æ–≤–µ—Ç: —Å—ã–≥—Ä–∞–π—Ç–µ 3 –¥—É—ç–ª–∏ –ø–æ–¥—Ä—è–¥, –∞ –∑–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ ‚Äú–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤‚Äù.
      </div>
    </section>

    <!-- Duel screen -->
    <section class="screen" id="screen-duel">
      <div class="card">
        <div class="duel-header">
          <span class="small-label" id="duel-mode-label">–†–µ–∂–∏–º: –ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å</span>
          <span class="small-label" id="duel-progress-label">–í–æ–ø—Ä–æ—Å 1 / 5</span>
        </div>

        <div class="versus-row">
          <div style="display:flex;align-items:center;gap:8px;">
            <div class="avatar" style="width:34px;height:34px;font-size:14px;" id="duel-player-avatar">P</div>
            <div style="font-size:12px;">
              <div id="duel-player-name" style="font-weight:600;">–í—ã</div>
              <div style="opacity:0.7;">–†–µ–π—Ç–∏–Ω–≥: <span id="duel-player-rating">100</span></div>
            </div>
          </div>
          <div style="text-align:center;">
            <div class="vs-label">–î—É—ç–ª—å</div>
            <div class="score-chip" id="duel-score-label">0 : 0</div>
          </div>
          <div style="display:flex;align-items:center;gap:8px;justify-content:flex-end;">
            <div style="font-size:12px;text-align:right;">
              <div id="duel-opponent-name" style="font-weight:600;">–°–æ–ø–µ—Ä–Ω–∏–∫</div>
              <div style="opacity:0.7;">–†–µ–π—Ç–∏–Ω–≥: <span id="duel-opponent-rating">100</span></div>
            </div>
            <div class="avatar" style="width:34px;height:34px;font-size:14px;background:linear-gradient(135deg,#ffffff,#FFE1B2);border-color:rgba(249,180,59,0.5);" id="duel-opponent-avatar">
              R
            </div>
          </div>
        </div>

        <div class="timer-bar">
          <div class="timer-fill" id="timer-fill"></div>
        </div>

        <div class="question-text" id="question-text">–í–æ–ø—Ä–æ—Å –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å.</div>
        <div class="question-meta" id="question-meta">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ‚Äî</div>

        <div class="answers" id="answers-container"></div>
      </div>

      <div class="card">
        <div class="section-title">–ü–æ–¥—Å–∫–∞–∑–∫–∞</div>
        <p style="font-size:12px;opacity:0.8;" id="duel-hint">
          –í —ç—Ç–æ–º –ø—Ä–æ—Ç–æ—Ç–∏–ø–µ —Å–æ–ø–µ—Ä–Ω–∏–∫ ‚Äî –ø—Ä–æ—Å—Ç–æ–π –±–æ—Ç. –í –±–æ–µ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏–≥—Ä–∞—Ç—å —Å –∫–æ–ª–ª–µ–≥–∞–º–∏ –ø–æ —Å–µ—Ç–∏.
        </p>
      </div>

      <div class="btn-row">
        <button class="btn btn-secondary btn-small" id="btn-duel-exit">–í—ã–π—Ç–∏</button>
        <button class="btn btn-ghost btn-small" id="btn-duel-skip">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞—É–Ω–¥</button>
      </div>
    </section>

    <!-- Result screen -->
    <section class="screen" id="screen-result">
      <div class="card card-hero">
        <div class="card-header">
          <div>
            <div class="card-title">–†–µ–∑—É–ª—å—Ç–∞—Ç –¥—É—ç–ª–∏</div>
            <div class="card-subtitle" id="result-subtitle">
              –•–æ—Ä–æ—à–∞—è –∏–≥—Ä–∞! –° –∫–∞–∂–¥–æ–π –¥—É—ç–ª—å—é –≤—ã –ª—É—á—à–µ –∑–Ω–∞–µ—Ç–µ –∫–æ–º–ø–∞–Ω–∏—é.
            </div>
          </div>
          <div class="pill" id="result-mode-pill">–ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å</div>
        </div>

        <div style="margin-top:10px;">
          <div class="result-main-score" id="result-score">3 : 2</div>
          <div class="result-status" id="result-status-label">–ü–æ–±–µ–¥–∞ üéâ</div>
          <div class="result-delta" id="result-delta-label">–†–µ–π—Ç–∏–Ω–≥: +15 ¬∑ –î—É—ç–ª–µ–π: +1</div>
        </div>
      </div>

      <div class="card">
        <div class="section-title">–ü—Ä–æ–≥—Ä–µ—Å—Å (—Å–±—Ä–æ—Å–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞)</div>
        <div class="list">
          <div class="list-item">
            <span>–¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥</span>
            <span class="pill-inline">üèÖ <span id="result-rating-value">115</span></span>
          </div>
          <div class="list-item">
            <span>–í—Å–µ–≥–æ –¥—É—ç–ª–µ–π</span>
            <span class="pill-inline">‚öîÔ∏è <span id="result-battles-value">1</span></span>
          </div>
          <div class="list-item">
            <span>–ü–æ–±–µ–¥—ã / –ø–æ—Ä–∞–∂–µ–Ω–∏—è</span>
            <span class="pill-inline">üéØ <span id="result-wl-value">1 / 0 / 0</span></span>
          </div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-primary" id="btn-result-again">–°—ã–≥—Ä–∞—Ç—å –µ—â—ë –¥—É—ç–ª—å</button>
        <button class="btn btn-secondary" id="btn-result-main">–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
      </div>
    </section>

    <!-- Badges screen -->
    <section class="screen" id="screen-badges">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">–ë–µ–π–¥–∂–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π</div>
            <div class="card-subtitle">–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –∑–≤–∞–Ω–∏—è –∑–∞ —Ä–µ–π—Ç–∏–Ω–≥ –∏ —É—á–∞—Å—Ç–∏–µ –≤ –¥—É—ç–ª—è—Ö.</div>
          </div>
          <div class="pill-inline">
            ‚≠ê <span id="badges-count-label">0 –∏–∑ 5</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="badge-grid" id="badge-grid"></div>
      </div>

      <button class="btn btn-secondary" id="btn-badges-back">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
    </section>

    <!-- Leaderboard screen -->
    <section class="screen" id="screen-leaderboard">
      <div class="card">
        <div class="card-header">
          <div>
            <div class="card-title">–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
            <div class="card-subtitle">
              –î–µ–º–æ-–ª–∏–¥–µ—Ä–±–æ—Ä–¥: –∫–∞–∫ –±—É–¥—Ç–æ –∏–≥—Ä–∞—é—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
              –í–∞—à–µ –º–µ—Å—Ç–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –¥—É—ç–ª–∏.
            </div>
          </div>
          <div class="pill-inline">
            üèÜ <span id="leaderboard-me-rating">–†–µ–π—Ç–∏–Ω–≥: 100</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="leader-header-row">
          <span>–ú–µ—Å—Ç–æ</span>
          <span>–ò–º—è</span>
          <span>–†–µ–π—Ç–∏–Ω–≥</span>
        </div>
        <div class="leader-list" id="leaderboard-list"></div>
      </div>

      <button class="btn btn-secondary" id="btn-leaderboard-back">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
    </section>
  </main>
</div>

<script>
  const questionBank = [
    {
      text: "–ö–∞–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –°–ò–ë–£–†–∞ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –∏ –æ—Ö—Ä–∞–Ω—ã —Ç—Ä—É–¥–∞?",
      category: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å",
      options: [
        "–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —ç–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤",
        "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å",
        "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞",
        "–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å"
      ],
      correctIndex: 1
    },
    {
      text: "–ß—Ç–æ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –ª—É—á—à–µ –≤—Å–µ–≥–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∫—É—Ä—Å –°–ò–ë–£–†–∞ –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ?",
      category: "–≠–∫–æ–ª–æ–≥–∏—è –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å",
      options: [
        "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä—ë–º–æ–≤ –ª—é–±—ã—Ö –≤–∏–¥–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞",
        "–û—Ç–∫–∞–∑ –æ—Ç —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏–∏",
        "–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª–∏–º–µ—Ä–æ–≤ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤",
        "–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
      ],
      correctIndex: 2
    },
    {
      text: "–ß—Ç–æ –≤ –±–æ–ª—å—à–µ–π —Å—Ç–µ–ø–µ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ?",
      category: "–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏",
      options: [
        "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π",
        "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞",
        "–ó–∞–ø—Ä–µ—Ç –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º",
        "–°–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤"
      ],
      correctIndex: 1
    },
    {
      text: "–ß—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–æ–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–∏?",
      category: "–ö–æ–º–∞–Ω–¥–Ω–æ—Å—Ç—å",
      options: [
        "–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –∫–æ–ª–ª–µ–≥",
        "–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –º–µ–∂–¥—É —Ü–µ—Ö–∞–º–∏",
        "–°–æ–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏",
        "–†–∞–±–æ—Ç–∞ —Ç–æ–ª—å–∫–æ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É ¬´–º–æ—è —Å–º–µ–Ω–∞ ‚Äî –º–æ–∏ –∑–∞–¥–∞—á–∏¬ª"
      ],
      correctIndex: 1
    },
    {
      text: "–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏?",
      category: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å",
      options: [
        "–°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π",
        "–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å, –Ω–∞—Ä—É—à–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
        "–°–æ–æ–±—â–∏—Ç—å –ø–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É –∫–∞–Ω–∞–ª—É –∏ –ø—Ä–∏–Ω—è—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ä—ã",
        "–ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å, –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã ‚Äî –Ω–æ—Ä–º–∞"
      ],
      correctIndex: 2
    },
    {
      text: "–ö–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–º–æ–≥–∞–µ—Ç —Å–Ω–∏–∂–∞—Ç—å –æ—Ç—Ö–æ–¥—ã –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞?",
      category: "–≠–∫–æ–ª–æ–≥–∏—è –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å",
      options: [
        "–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏",
        "–°–∏—Å—Ç–µ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–µ",
        "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä—ë–º–∞ —É–ø–∞–∫–æ–≤–∫–∏",
        "–û—Ç–∫–∞–∑ –æ—Ç —É—á—ë—Ç–∞ –æ—Ç—Ö–æ–¥–æ–≤"
      ],
      correctIndex: 1
    },
    {
      text: "–ß—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏ –Ω–∞ —Ä–∞–±–æ—á–µ–º –º–µ—Å—Ç–µ?",
      category: "–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏",
      options: [
        "–û–±–º–µ–Ω –∏–¥–µ—è–º–∏ –∏ –ø–æ–¥–∞—á–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º",
        "–ó–∞–ø—Ä–µ—Ç –Ω–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏–¥–µ–π",
        "–û–∂–∏–¥–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ ¬´—Å–≤–µ—Ä—Ö—É¬ª",
        "–ò–∑–æ–ª—è—Ü–∏—è –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞"
      ],
      correctIndex: 0
    }
  ];

  const badgesConfig = [
    {
      id: "rookie",
      title: "–ù–æ–≤–∏—á–æ–∫ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π",
      description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ 120 –∏ —Å—ã–≥—Ä–∞–π—Ç–µ 3 –¥—É—ç–ª–∏.",
      condition: (player) => player.rating >= 120 && player.battles >= 3
    },
    {
      id: "safety",
      title: "–ó–Ω–∞—Ç–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
      description: "–û—Ç–≤–µ—Ç—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∏–Ω–∏–º—É–º –≤ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.",
      condition: (player) => player.stats.safetyCorrect >= 5
    },
    {
      id: "eco",
      title: "–≠–∫–æ-–≥–µ—Ä–æ–π",
      description: "–û—Ç–≤–µ—Ç—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∏–Ω–∏–º—É–º –≤ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö –ø–æ —ç–∫–æ–ª–æ–≥–∏–∏.",
      condition: (player) => player.stats.ecoCorrect >= 5
    },
    {
      id: "innovator",
      title: "–ò–Ω–Ω–æ–≤–∞—Ç–æ—Ä",
      description: "–û—Ç–≤–µ—Ç—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∏–Ω–∏–º—É–º –≤ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö –ø–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º.",
      condition: (player) => player.stats.innovationCorrect >= 5
    },
    {
      id: "duelist",
      title: "–ú–∞—Å—Ç–µ—Ä –¥—É—ç–ª–µ–π",
      description: "–í—ã–∏–≥—Ä–∞–π—Ç–µ 10 –¥—É—ç–ª–µ–π.",
      condition: (player) => player.wins >= 10
    }
  ];

  const sampleOpponents = [
    { name: "–ò—Ä–∏–Ω–∞, –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è", rating: 130, initials: "–ò–†" },
    { name: "–ê–Ω–¥—Ä–µ–π, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ", rating: 145, initials: "–ê–ü" },
    { name: "–°–µ—Ä–≥–µ–π, —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è", rating: 160, initials: "–°–¶" },
    { name: "–ú–∞—Ä–∏—è, —ç–∫–æ–ª–æ–≥–∏—è", rating: 155, initials: "–ú–≠" }
  ];

  const baseLeaderboard = [
    { name: "–ê–Ω—Ç–æ–Ω, –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ", rating: 180, battles: 14, wins: 9 },
    { name: "–ú–∞—Ä–∏–Ω–∞, —Ñ–∏–Ω–∞–Ω—Å—ã",     rating: 165, battles: 11, wins: 7 },
    { name: "–ò–≥–æ—Ä—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", rating: 150, battles: 9,  wins: 6 },
    { name: "–û–ª—å–≥–∞, HR",           rating: 135, battles: 6,  wins: 3 },
    { name: "–î–º–∏—Ç—Ä–∏–π, –ò–¢",         rating: 120, battles: 5,  wins: 3 }
  ];

  let player = {
    name: "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –°–ò–ë–£–†",
    rating: 100,
    battles: 0,
    wins: 0,
    losses: 0,
    draws: 0,
    stats: {
      safetyCorrect: 0,
      ecoCorrect: 0,
      innovationCorrect: 0
    },
    badges: []
  };

  let gameState = {
    mode: "quick",
    opponent: null,
    questions: [],
    currentQuestionIndex: 0,
    playerScore: 0,
    opponentScore: 0,
    timerInterval: null,
    timerTimeout: null,
    timerTotalMs: 10000,
    questionAnswered: false
  };

  function $(id) { return document.getElementById(id); }

  function initialsFromName(name) {
    if (!name) return "S";
    const parts = name.split(" ").filter(Boolean);
    if (parts.length === 0) return name[0].toUpperCase();
    if (parts.length === 1) return parts[0][0].toUpperCase();
    return (parts[0][0] + parts[1][0]).toUpperCase();
  }

  function ratingLabel(rating) {
    if (rating < 120) return "–ù–æ–≤–∏—á–æ–∫";
    if (rating < 150) return "–£—á–∞—Å—Ç–Ω–∏–∫";
    if (rating < 200) return "–°–∏–ª—å–Ω—ã–π –∏–≥—Ä–æ–∫";
    if (rating < 250) return "–≠–∫—Å–ø–µ—Ä—Ç";
    return "–õ–µ–≥–µ–Ω–¥–∞";
  }

  function battlesLabel(battles) {
    if (battles === 0) return "0 –¥—É—ç–ª–µ–π";
    if (battles === 1) return "1 –¥—É—ç–ª—å";
    if (battles < 5) return battles + " –¥—É—ç–ª–∏";
    return battles + " –¥—É—ç–ª–µ–π";
  }

  function switchScreen(id) {
    document.querySelectorAll(".screen").forEach(el => {
      el.classList.toggle("active", el.id === id);
    });
  }

  function shuffle(array) {
    const arr = array.slice();
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function updateMainScreen() {
    $("player-name").textContent = player.name;
    $("player-avatar").textContent = initialsFromName(player.name);
    $("player-meta").textContent = `–†–µ–π—Ç–∏–Ω–≥: ${player.rating} ¬∑ –î—É—ç–ª–µ–π: ${player.battles}`;
    $("player-rating-label").textContent = ratingLabel(player.rating);
    $("player-battles-label").textContent = battlesLabel(player.battles);
  }

  function updateBadgesFromPlayer() {
    const unlockedIds = [];
    badgesConfig.forEach(b => {
      if (b.condition(player)) {
        unlockedIds.push(b.id);
      }
    });
    player.badges = unlockedIds;
  }

  function renderBadges() {
    updateBadgesFromPlayer();
    const container = $("badge-grid");
    container.innerHTML = "";
    const unlockedSet = new Set(player.badges);

    badgesConfig.forEach(badge => {
      const card = document.createElement("div");
      const unlocked = unlockedSet.has(badge.id);
      card.className = "badge-card" + (unlocked ? "" : " locked");

      const title = document.createElement("div");
      title.textContent = badge.title;
      title.style.fontWeight = "600";
      card.appendChild(title);

      const desc = document.createElement("div");
      desc.textContent = badge.description;
      desc.style.fontSize = "11px";
      desc.style.opacity = "0.8";
      card.appendChild(desc);

      const pill = document.createElement("div");
      pill.className = "badge-pill";
      pill.textContent = unlocked ? "–û—Ç–∫—Ä—ã—Ç–æ" : "–ü–æ–∫–∞ –∑–∞–∫—Ä—ã—Ç–æ";
      card.appendChild(pill);

      container.appendChild(card);
    });

    $("badges-count-label").textContent = `${player.badges.length} –∏–∑ ${badgesConfig.length}`;
  }

  function renderLeaderboard() {
    const players = baseLeaderboard.map(p => ({ ...p }));
    const meIndex = players.findIndex(p => p.name === player.name || p.name.startsWith(player.name + " "));
    const meData = {
      name: player.name + " (–≤—ã)",
      rating: player.rating,
      battles: player.battles,
      wins: player.wins
    };

    if (meIndex >= 0) {
      players[meIndex] = meData;
    } else {
      players.push(meData);
    }

    players.sort((a, b) => b.rating - a.rating);

    const container = $("leaderboard-list");
    container.innerHTML = "";

    players.forEach((p, idx) => {
      const row = document.createElement("div");
      const isMe = p.name.includes("(–≤—ã)");
      row.className = "leader-row" + (isMe ? " me" : "");

      const pos = document.createElement("div");
      pos.className = "leader-pos";
      pos.textContent = idx + 1;
      row.appendChild(pos);

      const nameCol = document.createElement("div");
      nameCol.className = "leader-name";
      const main = document.createElement("div");
      main.className = "leader-name-main";
      main.textContent = p.name;
      const sub = document.createElement("div");
      sub.className = "leader-name-sub";
      sub.textContent = `–î—É—ç–ª–µ–π: ${p.battles || 0}, –ø–æ–±–µ–¥: ${p.wins || 0}`;
      nameCol.appendChild(main);
      nameCol.appendChild(sub);
      row.appendChild(nameCol);

      const score = document.createElement("div");
      score.className = "leader-score";
      score.textContent = p.rating;
      row.appendChild(score);

      container.appendChild(row);
    });

    $("leaderboard-me-rating").textContent = `–†–µ–π—Ç–∏–Ω–≥: ${player.rating}`;
  }

  function resetTimer() {
    if (gameState.timerInterval) {
      clearInterval(gameState.timerInterval);
      gameState.timerInterval = null;
    }
    if (gameState.timerTimeout) {
      clearTimeout(gameState.timerTimeout);
      gameState.timerTimeout = null;
    }
  }

  function prepareDuel(mode) {
    gameState.mode = mode;
    gameState.questions = shuffle(questionBank).slice(0, 5);
    gameState.currentQuestionIndex = 0;
    gameState.playerScore = 0;
    gameState.opponentScore = 0;
    gameState.questionAnswered = false;

    const opp = sampleOpponents[Math.floor(Math.random() * sampleOpponents.length)];
    gameState.opponent = {
      name: mode === "bot" ? opp.name + " (–ò–ò)" : opp.name,
      rating: opp.rating,
      initials: opp.initials
    };

    $("duel-mode-label").textContent = mode === "bot"
      ? "–†–µ–∂–∏–º: –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å –ò–ò-—Å–æ–ø–µ—Ä–Ω–∏–∫–æ–º"
      : "–†–µ–∂–∏–º: –ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å";
    $("duel-player-name").textContent = "–í—ã";
    $("duel-player-rating").textContent = player.rating;
    $("duel-player-avatar").textContent = initialsFromName(player.name);
    $("duel-opponent-name").textContent = gameState.opponent.name;
    $("duel-opponent-rating").textContent = gameState.opponent.rating;
    $("duel-opponent-avatar").textContent = gameState.opponent.initials;

    $("duel-hint").textContent = gameState.mode === "bot"
      ? "–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ä–µ–∂–∏–º: —Ä–µ–π—Ç–∏–Ω–≥ –º–µ–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–Ω–æ, –Ω–æ –ª–æ–≥–∏–∫–∞ —Ç–∞–∫–∞—è –∂–µ."
      : "–†–µ–π—Ç–∏–Ω–≥–æ–≤–∞—è –¥—É—ç–ª—å: –ø–æ–±–µ–¥–∞ –ø—Ä–∏–Ω–æ—Å–∏—Ç –±–æ–ª—å—à–µ —Ä–µ–π—Ç–∏–Ω–≥–∞.";

    showQuestion();
  }

  function showQuestion() {
    resetTimer();
    const idx = gameState.currentQuestionIndex;
    const q = gameState.questions[idx];
    $("duel-progress-label").textContent = `–í–æ–ø—Ä–æ—Å ${idx + 1} / ${gameState.questions.length}`;
    $("duel-score-label").textContent = `${gameState.playerScore} : ${gameState.opponentScore}`;
    $("question-text").textContent = q.text;
    $("question-meta").textContent = `–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${q.category}`;
    const container = $("answers-container");
    container.innerHTML = "";
    gameState.questionAnswered = false;

    q.options.forEach((opt, i) => {
      const btn = document.createElement("button");
      btn.className = "answer-btn";
      btn.dataset.index = String(i);

      const idxSpan = document.createElement("span");
      idxSpan.className = "index";
      idxSpan.textContent = String.fromCharCode(65 + i);
      btn.appendChild(idxSpan);

      const textSpan = document.createElement("span");
      textSpan.className = "text";
      textSpan.textContent = opt;
      btn.appendChild(textSpan);

      btn.addEventListener("click", () => handlePlayerAnswer(i, btn));
      container.appendChild(btn);
    });

    const timerFill = $("timer-fill");
    timerFill.style.transform = "scaleX(1)";
    const total = gameState.timerTotalMs;
    const start = performance.now();

    gameState.timerInterval = setInterval(() => {
      const now = performance.now();
      const elapsed = now - start;
      const ratio = Math.max(0, 1 - elapsed / total);
      timerFill.style.transform = `scaleX(${ratio})`;
    }, 80);

    gameState.timerTimeout = setTimeout(() => {
      if (!gameState.questionAnswered) {
        handlePlayerAnswer(null, null, true);
      }
    }, total);

    simulateOpponentAnswer(q);
  }

  function simulateOpponentAnswer(question) {
    const baseDelay = 1200;
    const extra = Math.random() * 2600;
    const delay = baseDelay + extra;
    const willAnswerCorrect = Math.random() < 0.7;
    setTimeout(() => {
      const idx = gameState.questions.indexOf(question);
      if (idx === -1 || idx !== gameState.currentQuestionIndex) return;
      if (!gameState.questionAnswered) {
        if (willAnswerCorrect) {
          gameState.opponentScore++;
        }
        $("duel-score-label").textContent = `${gameState.playerScore} : ${gameState.opponentScore}`;
      }
    }, delay);
  }

  function handlePlayerAnswer(optionIndex, btn, isTimeout = false) {
    if (gameState.questionAnswered) return;
    gameState.questionAnswered = true;
    resetTimer();

    const q = gameState.questions[gameState.currentQuestionIndex];
    const correctIdx = q.correctIndex;
    const answersButtons = Array.from(document.querySelectorAll("#answers-container .answer-btn"));

    answersButtons.forEach((b) => {
      b.classList.add("disabled");
      const idx = parseInt(b.dataset.index, 10);
      if (idx === correctIdx) {
        b.classList.add("correct");
      }
    });

    let playerCorrect = false;

    if (optionIndex !== null && optionIndex === correctIdx) {
      playerCorrect = true;
      gameState.playerScore++;
      if (btn) btn.classList.add("correct");
    } else if (optionIndex !== null && optionIndex !== correctIdx) {
      if (btn) btn.classList.add("wrong");
    }

    $("duel-score-label").textContent = `${gameState.playerScore} : ${gameState.opponentScore}`;

    if (playerCorrect) {
      if (q.category.includes("–ë–µ–∑–æ–ø–∞—Å")) {
        player.stats.safetyCorrect++;
      } else if (q.category.includes("–≠–∫–æ–ª–æ–≥")) {
        player.stats.ecoCorrect++;
      } else if (q.category.includes("–ò–Ω–Ω–æ–≤–∞—Ü")) {
        player.stats.innovationCorrect++;
      }
    }

    setTimeout(() => {
      gameState.currentQuestionIndex++;
      if (gameState.currentQuestionIndex >= gameState.questions.length) {
        finishDuel();
      } else {
        showQuestion();
      }
    }, 900);
  }

  function finishDuel() {
    resetTimer();
    const playerScore = gameState.playerScore;
    const opponentScore = gameState.opponentScore;
    const mode = gameState.mode;

    let statusText = "";
    let deltaRating = 0;

    player.battles++;

    if (playerScore > opponentScore) {
      statusText = "–ü–æ–±–µ–¥–∞ üéâ";
      player.wins++;
      deltaRating = mode === "quick" ? 15 : 5;
    } else if (playerScore < opponentScore) {
      statusText = "–ü–æ—Ä–∞–∂–µ–Ω–∏–µ ‚Äî –Ω–æ –æ–ø—ã—Ç –µ—Å—Ç—å üí™";
      player.losses++;
      deltaRating = mode === "quick" ? 5 : 3;
    } else {
      statusText = "–ù–∏—á—å—è ü§ù";
      player.draws++;
      deltaRating = mode === "quick" ? 10 : 4;
    }

    player.rating += deltaRating;
    if (player.rating < 0) player.rating = 0;

    updateBadgesFromPlayer();

    $("result-score").textContent = `${playerScore} : ${opponentScore}`;
    $("result-status-label").textContent = statusText;
    $("result-delta-label").textContent = `–†–µ–π—Ç–∏–Ω–≥: ${deltaRating >= 0 ? "+" : ""}${deltaRating} ¬∑ –î—É—ç–ª–µ–π: +1`;
    $("result-rating-value").textContent = player.rating;
    $("result-battles-value").textContent = player.battles;
    $("result-wl-value").textContent = `${player.wins} / ${player.losses} / ${player.draws}`;

    $("result-mode-pill").textContent = mode === "quick" ? "–ë—ã—Å—Ç—Ä–∞—è –¥—É—ç–ª—å" : "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞";
    $("result-subtitle").textContent =
      mode === "quick"
        ? "–≠—Ç–∞ –¥—É—ç–ª—å —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ—ë –º–µ—Å—Ç–æ –≤–æ –≤–∫–ª–∞–¥–∫–µ ‚Äú–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤‚Äù."
        : "–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ä–µ–∂–∏–º: —Ä–µ–π—Ç–∏–Ω–≥ —Ä–∞—Å—Ç—ë—Ç –º—è–≥—á–µ, –Ω–æ –æ–ø—ã—Ç —Ç–æ—Ç –∂–µ.";

    switchScreen("screen-result");
  }

  function init() {
    updateMainScreen();

    $("btn-demo-name").addEventListener("click", () => {
      $("input-name").value = "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤";
    });

    $("btn-enter").addEventListener("click", () => {
      const name = $("input-name").value.trim() || "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –°–ò–ë–£–†";
      player.name = name;
      updateMainScreen();
      switchScreen("screen-main");
    });

    $("btn-play-quick").addEventListener("click", () => {
      prepareDuel("quick");
      switchScreen("screen-duel");
    });

    $("btn-play-bot").addEventListener("click", () => {
      prepareDuel("bot");
      switchScreen("screen-duel");
    });

    $("menu-badges").addEventListener("click", () => {
      renderBadges();
      switchScreen("screen-badges");
    });

    $("menu-leaderboard").addEventListener("click", () => {
      renderLeaderboard();
      switchScreen("screen-leaderboard");
    });

    $("btn-duel-exit").addEventListener("click", () => {
      resetTimer();
      updateMainScreen();
      switchScreen("screen-main");
    });

    $("btn-duel-skip").addEventListener("click", () => {
      resetTimer();
      finishDuel();
    });

    $("btn-result-again").addEventListener("click", () => {
      updateMainScreen();
      prepareDuel("quick");
      switchScreen("screen-duel");
    });

    $("btn-result-main").addEventListener("click", () => {
      updateMainScreen();
      switchScreen("screen-main");
    });

    $("btn-badges-back").addEventListener("click", () => {
      updateMainScreen();
      switchScreen("screen-main");
    });

    $("btn-leaderboard-back").addEventListener("click", () => {
      updateMainScreen();
      switchScreen("screen-main");
    });
  }

  document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
